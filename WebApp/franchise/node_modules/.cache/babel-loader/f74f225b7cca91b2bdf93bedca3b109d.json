{"ast":null,"code":"var _jsxFileName = \"/home/iassureit/PriyaiAssureITWork/eCommTwo/WebApp/franchise/src/StoreManagement/product/productBulkUpload/component/TemplateManagement.js\";\nimport React, { Component } from 'react';\nimport $ from 'jquery';\nimport axios from 'axios';\nimport swal from 'sweetalert';\nimport _ from 'underscore';\nimport { withRouter } from 'react-router-dom';\nimport XLSX from \"xlsx\";\nimport S3FileUpload from 'react-s3';\nimport Loader from '../../../../coreadmin/common/Loader/Loader.js';\nimport Message from '../../../../storeAdmin/message/Message.js';\nimport IAssureTable from '../../../../coreadmin/IAssureTable/IAssureTable.jsx';\nimport ProductList from '../../productList/component/ProductList.js';\n\nclass TemplateManagement extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      fileObj: [],\n      \"tableHeading\": {\n        section: \"Section\",\n        category: \"Category\",\n        templateUrl: \"Template URL\",\n        actions: 'Action'\n      },\n      \"tableObjects\": {\n        deleteMethod: 'delete',\n        apiLink: '/api/bulkUploadTemplate',\n        paginationApply: true,\n        searchApply: false\n      },\n      \"startRange\": 0,\n      \"limitRange\": 10\n    }; //this.fileInput = React.createRef();\n  }\n\n  componentWillReceiveProps(nextProps) {}\n\n  componentDidMount() {\n    this.getSectionData();\n    $(\"#addTemplate\").validate({\n      rules: {\n        section: {\n          required: true\n        },\n        category: {\n          required: true\n        },\n        templatefile: {\n          required: true\n        }\n      },\n      errorPlacement: function (error, element) {\n        if (element.attr(\"name\") === \"section\") {\n          error.insertAfter(\"#section\");\n        }\n\n        if (element.attr(\"name\") === \"category\") {\n          error.insertAfter(\"#category\");\n        }\n\n        if (element.attr(\"name\") === \"templatefile\") {\n          error.insertAfter(\"#templateError\");\n        }\n      }\n    });\n    this.getData(this.state.startRange, this.state.limitRange);\n  }\n\n  getSectionData() {\n    axios.get('/api/sections/get/list').then(response => {\n      // console.log('getWebCategories', response.data);\n      this.setState({\n        sectionArray: response.data\n      });\n    }).catch(error => {\n      console.log('error', error);\n    });\n  }\n\n  showRelevantCategories(event) {\n    var section = event.target.value;\n    this.setState({\n      section: event.target.value,\n      section_ID: event.target.value.split('|')[1],\n      messageData: {}\n    });\n    axios.get('/api/category/get/list/' + event.target.value.split('|')[1]).then(response => {\n      this.setState({\n        categoryArray: response.data,\n        category: \"Select Category\",\n        subCategory: \"Select Sub-Category\"\n      });\n    }).catch(error => {\n      console.log('error', error);\n    });\n  }\n\n  handleChangeCategory(event) {\n    event.preventDefault();\n    this.setState({\n      category: event.target.value,\n      category_ID: event.target.value.split('|')[1],\n      messageData: {}\n    });\n  }\n\n  docBrowse(e) {\n    e.preventDefault();\n    var fileObj = e.currentTarget.files[0];\n\n    if (fileObj) {\n      var fileName = fileObj.name;\n      var ext = fileName.split('.').pop();\n      console.log('ext', ext);\n\n      if (ext == \"xlsx\" || ext == \"xls\") {\n        this.setState({\n          fileObj: fileObj,\n          validFormat: true,\n          messageData: {}\n        }, () => {});\n      } else {\n        this.setState({\n          finalData: [],\n          validFormat: false,\n          messageData: {\n            \"type\": \"outpage\",\n            \"icon\": \"fa fa-exclamation\",\n            \"message\": \"Invalid file format.\",\n            \"class\": \"warning\",\n            \"autoDismiss\": true\n          }\n        });\n      }\n    }\n  }\n\n  clicktoattach(event) {\n    event.preventDefault();\n    $(\"#upload-file\").click();\n  }\n\n  addTemplate(event) {\n    event.preventDefault();\n    console.log('validFormat', this.fileInput);\n\n    if ($('#addTemplate').valid() && this.state.validFormat) {\n      var fileObj = this.state.fileObj;\n      main().then(templateUrl => {\n        this.setState({\n          templateUrl: templateUrl\n        });\n        var formValues = {\n          section_ID: $('#section').val().split('|')[1],\n          section: $('#section').val().split('|')[0],\n          category_ID: $('#category').val().split('|')[1],\n          category: $('#category').val().split('|')[0],\n          templateUrl: templateUrl\n        };\n        console.log('formValues', formValues);\n        axios.post(\"/api/bulkUploadTemplate/post/addBulkUploadTemplate\", formValues).then(response => {\n          //this.fileInput.value = '';\n          // this.fileInput.value = \"\";\n          this.setState({\n            finalData: [],\n            section: \"Select Section\",\n            category: \"Select Category\",\n            messageData: {\n              \"type\": \"outpage\",\n              \"icon\": \"fa fa-correct\",\n              \"message\": \"Template is added successfully.\",\n              \"class\": \"success\",\n              \"autoDismiss\": true\n            }\n          });\n          this.getData(this.state.startRange, this.state.limitRange);\n        }).catch(error => {\n          console.log(error.message);\n          this.setState({\n            finalData: [],\n            messageData: {\n              \"type\": \"outpage\",\n              \"icon\": \"fa fa-exclamation\",\n              \"message\": \"Failed to save\",\n              \"class\": \"warning\",\n              \"autoDismiss\": true\n            }\n          });\n        });\n      });\n\n      async function main() {\n        var config = await getConfig();\n        var s3url = await s3upload(fileObj, config, this); //console.log('s3url',s3url);\n\n        return Promise.resolve(s3url);\n      }\n\n      function s3upload(image, configuration) {\n        return new Promise(function (resolve, reject) {\n          S3FileUpload.uploadFile(image, configuration).then(Data => {\n            resolve(Data.location);\n          }).catch(error => {\n            console.log(error);\n          });\n        });\n      }\n\n      function getConfig() {\n        return new Promise(function (resolve, reject) {\n          axios.get('http://qagangaexpressapi.iassureit.com/api/projectSettings/get/one/s3').then(response => {\n            console.log(\"proj set res = \", response.data);\n            const config = {\n              bucketName: response.data.bucket,\n              dirName: 'propertiesImages',\n              region: response.data.region,\n              accessKeyId: response.data.key,\n              secretAccessKey: response.data.secret\n            };\n            resolve(config);\n          }).catch(function (error) {\n            console.log(error);\n          });\n        });\n      }\n    }\n\n    if ($('#addTemplate').valid()) {\n      if (!this.state.validFormat) {\n        this.setState({\n          messageData: {\n            \"type\": \"outpage\",\n            \"icon\": \"fa fa-exclamation\",\n            \"message\": \"Invalid file format.\",\n            \"class\": \"warning\",\n            \"autoDismiss\": true\n          }\n        });\n      }\n    }\n  }\n\n  getDataCount() {\n    axios.get('/api/bulkUploadTemplate/get/count').then(response => {\n      this.setState({\n        dataCount: response.data.dataCount\n      });\n    }).catch(error => {\n      console.log('error', error);\n    });\n  }\n\n  getData(startRange, limitRange) {\n    this.setState({\n      messageData: {}\n    });\n    this.getDataCount();\n    var data = {\n      startRange: startRange,\n      limitRange: limitRange\n    };\n    axios.get('/api/bulkUploadTemplate/get/list', data).then(response => {\n      console.log(response.data);\n      var tableData = response.data.map((a, i) => {\n        return {\n          _id: a._id,\n          section: a.section,\n          category: a.category,\n          templateUrl: \"<a href='\" + a.templateUrl + \"' download><img src='https://s3.ap-south-1.amazonaws.com/assureidportal/websiteImgs/filecsv.png' style='width:35px' /></a>\"\n        };\n      }); // console.log('table', tableData);\n\n      this.setState({\n        tableData: tableData\n      });\n    }).catch(error => {\n      console.log('error', error);\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 NOpadding-right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"section\", {\n      className: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-12 col-md-12 col-xs-12 col-sm-12 pageContent\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Loader, {\n      type: \"fullpageLoader\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(Message, {\n      messageData: this.state.messageData,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"addNewProductWrap col-lg-12 col-md-12 col-sm-12 col-xs-12 add-new-productCol\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"box\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"box-header with-border col-lg-12 col-md-12 col-xs-12 col-sm-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      className: \"NOpadding-right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 31\n      }\n    }, \"Product Bulk Upload Template\")), /*#__PURE__*/React.createElement(\"form\", {\n      className: \"newTemplateForm\",\n      id: \"addTemplate\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 NoPadding\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-4 col-lg-offset-2  col-md-4 col-md-offset-2 col-sm-4 col-sm-offset-2  col-xs-6 inputFields marginTopp\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 31\n      }\n    }, \"Section \", /*#__PURE__*/React.createElement(\"i\", {\n      className: \"redFont\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 46\n      }\n    }, \"*\")), /*#__PURE__*/React.createElement(\"select\", {\n      onChange: this.showRelevantCategories.bind(this),\n      value: this.state.section,\n      name: \"section\",\n      className: \"form-control\",\n      \"aria-describedby\": \"basic-addon1\",\n      id: \"section\",\n      ref: \"section\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 31\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      disabled: true,\n      selected: true,\n      defaultValue: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 35\n      }\n    }, \"Select Section\"), this.state.sectionArray && this.state.sectionArray.length > 0 ? this.state.sectionArray.map((data, index) => {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        key: index,\n        value: data.section + '|' + data._id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 47\n        }\n      }, data.section);\n    }) : /*#__PURE__*/React.createElement(\"option\", {\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 39\n      }\n    }, \"Section not available\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-4 col-md-4 col-sm-4 col-xs-6 inputFields marginTopp\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 31\n      }\n    }, \"Category \", /*#__PURE__*/React.createElement(\"i\", {\n      className: \"redFont\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 47\n      }\n    }, \"*\")), /*#__PURE__*/React.createElement(\"select\", {\n      onChange: this.handleChangeCategory.bind(this),\n      value: this.state.section,\n      name: \"category\",\n      value: this.state.category,\n      className: \"form-control\",\n      \"aria-describedby\": \"basic-addon1\",\n      id: \"category\",\n      ref: \"category\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 31\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      disabled: true,\n      selected: true,\n      defaultValue: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 35\n      }\n    }, \"Select Category\"), this.state.categoryArray && this.state.sectionArray.length > 0 ? this.state.categoryArray.map((data, index) => {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        key: index,\n        value: data.category + '|' + data._id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 47\n        }\n      }, data.category);\n    }) : /*#__PURE__*/React.createElement(\"option\", {\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 39\n      }\n    }, \"Category not available\")))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-4 col-lg-offset-2 col-md-4 col-md-offset-2  col-sm-4 col-xs-6  inputFields\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 31\n      }\n    }, \"Select File \", /*#__PURE__*/React.createElement(\"i\", {\n      className: \"redFont\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 50\n      }\n    }, \"*\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 31\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"adminBlkUpldIcon input-group-addon\",\n      id: \"basic-addon1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 35\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fa fa-cloud-upload\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 106\n      }\n    })), /*#__PURE__*/React.createElement(\"input\", {\n      className: \"form-control adminBlkUploadBtn\",\n      name: \"templatefile\",\n      id: \"templatefile\",\n      ref: this.fileInput,\n      type: \"file\",\n      accept: \".xlsx, .xls\",\n      onChange: this.docBrowse.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 35\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"templateError\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 31\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"upldProdFileHere\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 31\n      }\n    }, \" Upload Your Template File Here:\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-4 col-md-4 col-sm-12 col-xs-12 mt\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.addTemplate.bind(this),\n      className: \"submitBtn btn btnSubmit col-lg-4 col-md-4 col-sm-3 col-xs-3 pull-left\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 31\n      }\n    }, \"Save\")), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(IAssureTable, {\n      tableHeading: this.state.tableHeading,\n      twoLevelHeader: this.state.twoLevelHeader,\n      dataCount: this.state.dataCount,\n      tableData: this.state.tableData,\n      getData: this.getData.bind(this),\n      tableObjects: this.state.tableObjects,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 27\n      }\n    })))))));\n  }\n\n}\n\nexport default withRouter(TemplateManagement);","map":{"version":3,"sources":["/home/iassureit/PriyaiAssureITWork/eCommTwo/WebApp/franchise/src/StoreManagement/product/productBulkUpload/component/TemplateManagement.js"],"names":["React","Component","$","axios","swal","_","withRouter","XLSX","S3FileUpload","Loader","Message","IAssureTable","ProductList","TemplateManagement","constructor","props","state","fileObj","section","category","templateUrl","actions","deleteMethod","apiLink","paginationApply","searchApply","componentWillReceiveProps","nextProps","componentDidMount","getSectionData","validate","rules","required","templatefile","errorPlacement","error","element","attr","insertAfter","getData","startRange","limitRange","get","then","response","setState","sectionArray","data","catch","console","log","showRelevantCategories","event","target","value","section_ID","split","messageData","categoryArray","subCategory","handleChangeCategory","preventDefault","category_ID","docBrowse","e","currentTarget","files","fileName","name","ext","pop","validFormat","finalData","clicktoattach","click","addTemplate","fileInput","valid","main","formValues","val","post","message","config","getConfig","s3url","s3upload","Promise","resolve","image","configuration","reject","uploadFile","Data","location","bucketName","bucket","dirName","region","accessKeyId","key","secretAccessKey","secret","getDataCount","dataCount","tableData","map","a","i","_id","render","bind","length","index","tableHeading","twoLevelHeader","tableObjects"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport $            from 'jquery';\nimport axios        from 'axios';\nimport swal         from 'sweetalert';\nimport _            from 'underscore';\nimport {withRouter} from 'react-router-dom';\nimport XLSX         from \"xlsx\";\nimport S3FileUpload from 'react-s3';\n\nimport Loader       from '../../../../coreadmin/common/Loader/Loader.js';\nimport Message      from '../../../../storeAdmin/message/Message.js';\nimport IAssureTable from '../../../../coreadmin/IAssureTable/IAssureTable.jsx';\nimport ProductList  from '../../productList/component/ProductList.js';\n\nclass TemplateManagement extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            fileObj:[],\n            \"tableHeading\"                 : {\n                section                    : \"Section\",\n                category                   : \"Category\",\n                templateUrl                : \"Template URL\",\n                actions                    : 'Action',\n            },\n            \"tableObjects\"                 : {\n                deleteMethod               : 'delete',\n                apiLink                    : '/api/bulkUploadTemplate',\n                paginationApply            : true,\n                searchApply                : false\n            },\n              \"startRange\"                 : 0,\n              \"limitRange\"                 : 10\n        }\n        //this.fileInput = React.createRef();\n    }\n\n    componentWillReceiveProps(nextProps) {\n        \n    }\n\n    componentDidMount() {\n        this.getSectionData();\n        $(\"#addTemplate\").validate({\n        rules: {\n            section: {\n              required: true\n            },\n            category: {\n              required: true\n            },\n            templatefile: {\n              required: true,\n            }\n        },\n        errorPlacement: function (error, element) {\n            if (element.attr(\"name\") === \"section\") {\n              error.insertAfter(\"#section\");\n            }\n            if (element.attr(\"name\") === \"category\") {\n              error.insertAfter(\"#category\");\n            }\n            if (element.attr(\"name\") === \"templatefile\") {\n              error.insertAfter(\"#templateError\");\n            }\n        }\n        })\n        this.getData(this.state.startRange, this.state.limitRange);\n    }\n    getSectionData() {\n    axios.get('/api/sections/get/list')\n      .then((response) => {\n        // console.log('getWebCategories', response.data);\n        this.setState({\n          sectionArray: response.data\n        })\n      })\n      .catch((error) => {\n        console.log('error', error);\n      })\n    }\n    showRelevantCategories(event) {\n    var section = event.target.value;\n    this.setState({\n      section: event.target.value,\n      section_ID: event.target.value.split('|')[1],\n      messageData : {}\n    })\n\n    axios.get('/api/category/get/list/' + event.target.value.split('|')[1])\n      .then((response) => {\n        this.setState({\n          categoryArray: response.data,\n          category: \"Select Category\",\n          subCategory: \"Select Sub-Category\",\n        })\n      })\n      .catch((error) => {\n        console.log('error', error);\n      })\n    }\n    handleChangeCategory(event){\n        event.preventDefault();\n        this.setState({\n          category: event.target.value,\n          category_ID: event.target.value.split('|')[1],\n          messageData : {}\n        })\n    }\n    docBrowse(e){\n    e.preventDefault();\n\n        var fileObj = e.currentTarget.files[0];\n        \n        if (fileObj) {\n            var fileName  = fileObj.name; \n            var ext = fileName.split('.').pop();  \n            console.log('ext',ext)\n            if(ext==\"xlsx\" || ext==\"xls\"){\n                this.setState({ fileObj: fileObj, validFormat: true, messageData : {} },()=>{});\n            }else{\n                this.setState({\n                    finalData: [],\n                    validFormat: false,\n                    messageData : {\n                      \"type\" : \"outpage\",\n                      \"icon\" : \"fa fa-exclamation\",\n                      \"message\" : \"Invalid file format.\",\n                      \"class\": \"warning\",\n                      \"autoDismiss\" : true\n                    }\n                })\n            } \n        }\n       \n    }\n    clicktoattach(event){\n        event.preventDefault();\n        $(\"#upload-file\").click();\n    }\n    addTemplate(event){\n        event.preventDefault();\n        console.log('validFormat',this.fileInput);\n        if($('#addTemplate').valid() && this.state.validFormat){\n            var fileObj = this.state.fileObj;\n            main().then(templateUrl=>{\n              \n              this.setState({templateUrl : templateUrl})\n                var formValues = {\n                    section_ID                : $('#section').val().split('|')[1], \n                    section                   : $('#section').val().split('|')[0], \n                    category_ID               : $('#category').val().split('|')[1], \n                    category                  : $('#category').val().split('|')[0], \n                    templateUrl               : templateUrl,\n                }\n                console.log('formValues', formValues);\n                axios.post(\"/api/bulkUploadTemplate/post/addBulkUploadTemplate\",formValues)\n                      .then((response)=>{\n                        //this.fileInput.value = '';\n                       // this.fileInput.value = \"\";\n                        this.setState({\n                            finalData: [],\n                            section : \"Select Section\",\n                            category : \"Select Category\",\n                            messageData : {\n                              \"type\" : \"outpage\",\n                              \"icon\" : \"fa fa-correct\",\n                              \"message\" : \"Template is added successfully.\",\n                              \"class\": \"success\",\n                              \"autoDismiss\" : true\n                            }\n                        })\n                        this.getData(this.state.startRange, this.state.limitRange);\n                      })\n                      .catch((error)=>{\n                        console.log(error.message)\n                          this.setState({\n                            finalData: [],\n                            messageData : {\n                              \"type\" : \"outpage\",\n                              \"icon\" : \"fa fa-exclamation\",\n                              \"message\" : \"Failed to save\",\n                              \"class\": \"warning\",\n                              \"autoDismiss\" : true\n                            }\n                        })\n                    })\n            });\n\n            async function main(){\n                var config = await getConfig();\n                var s3url = await s3upload(fileObj, config, this);\n                //console.log('s3url',s3url);\n                return Promise.resolve(s3url);\n            }\n          function s3upload(image,configuration){\n            return new Promise(function(resolve,reject){\n                S3FileUpload\n                   .uploadFile(image,configuration)\n                   .then((Data)=>{\n                        resolve(Data.location);\n                   })\n                   .catch((error)=>{\n                        console.log(error);\n                   })\n            })\n          }   \n          function getConfig(){\n            return new Promise(function(resolve,reject){\n                axios\n                   .get('http://qagangaexpressapi.iassureit.com/api/projectSettings/get/one/s3')\n                   .then((response)=>{\n                        console.log(\"proj set res = \",response.data);\n                        const config = {\n                            bucketName      : response.data.bucket,\n                            dirName         : 'propertiesImages',\n                            region          : response.data.region,\n                            accessKeyId     : response.data.key,\n                            secretAccessKey : response.data.secret,\n                        }\n                        resolve(config);                           \n                    })\n                   .catch(function(error){\n                        console.log(error);\n                   })\n            })\n          }\n        }\n        if ($('#addTemplate').valid()) {\n          if(!this.state.validFormat){\n            this.setState({\n              messageData : {\n                \"type\" : \"outpage\",\n                \"icon\" : \"fa fa-exclamation\",\n                \"message\" : \"Invalid file format.\",\n                \"class\": \"warning\",\n                \"autoDismiss\" : true\n              }\n          })\n          }\n        }\n    }\n    getDataCount(){\n        axios.get('/api/bulkUploadTemplate/get/count')\n        .then((response)=>{\n          this.setState({\n            dataCount : response.data.dataCount\n          })\n        })\n        .catch((error)=>{\n          console.log('error', error);\n        });\n    }\n    getData(startRange, limitRange){\n      this.setState({ messageData : {} })\n        this.getDataCount();\n        var data={\n            startRange : startRange,\n            limitRange : limitRange\n        }\n        axios.get('/api/bulkUploadTemplate/get/list', data)\n        .then((response)=>{\n\n            console.log(response.data)\n            \n            var tableData = response.data.map((a, i)=>{\n                return {\n                    _id             : a._id,\n                    section         : a.section,\n                    category        : a.category,\n                    templateUrl     : \"<a href='\"+a.templateUrl+\"' download><img src='https://s3.ap-south-1.amazonaws.com/assureidportal/websiteImgs/filecsv.png' style='width:35px' /></a>\"\n                }\n            })\n            // console.log('table', tableData);\n            this.setState({\n                tableData : tableData\n            });\n        })\n        .catch((error)=>{\n            console.log('error', error);\n        });\n    }\n    \n    render() {\n        \n        return (\n        <div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 NOpadding-right\">\n            <section className=\"content\">\n            <div className=\"col-lg-12 col-md-12 col-xs-12 col-sm-12 pageContent\">\n            <Loader type=\"fullpageLoader\" />\n            <Message messageData={this.state.messageData} />\n                <div className=\"row\">\n                    <div className=\"addNewProductWrap col-lg-12 col-md-12 col-sm-12 col-xs-12 add-new-productCol\">\n                      <div className=\"box\">\n                          <div className=\"box-header with-border col-lg-12 col-md-12 col-xs-12 col-sm-12\">\n                              <h4 className=\"NOpadding-right\">Product Bulk Upload Template</h4>\n                          </div>\n\n                          <form className=\"newTemplateForm\" id=\"addTemplate\">\n                          <div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 NoPadding\">\n                          <div className=\"col-lg-4 col-lg-offset-2  col-md-4 col-md-offset-2 col-sm-4 col-sm-offset-2  col-xs-6 inputFields marginTopp\">\n                              <label>Section <i className=\"redFont\">*</i></label>\n                              <select onChange={this.showRelevantCategories.bind(this)} value={this.state.section} name=\"section\" className=\"form-control\" aria-describedby=\"basic-addon1\" id=\"section\" ref=\"section\">\n                                  <option disabled selected defaultValue=\"\">Select Section</option>\n                                  {this.state.sectionArray && this.state.sectionArray.length > 0 ?\n                                      this.state.sectionArray.map((data, index) => {\n                                          return (\n                                              <option key={index} value={data.section + '|' + data._id} >{data.section}</option>\n                                          );\n                                      })\n                                      :\n                                      <option disabled>{\"Section not available\"}</option>\n                                  }\n                              </select>\n                          </div>\n                          <div className=\"col-lg-4 col-md-4 col-sm-4 col-xs-6 inputFields marginTopp\">\n                              <label>Category <i className=\"redFont\">*</i></label>\n                              <select onChange={this.handleChangeCategory .bind(this)} value={this.state.section} name=\"category\" value={this.state.category}  className=\"form-control\" aria-describedby=\"basic-addon1\" id=\"category\" ref=\"category\">\n                                  <option disabled selected defaultValue=\"\">Select Category</option>\n                                  {this.state.categoryArray && this.state.sectionArray.length > 0 ?\n                                      this.state.categoryArray.map((data, index) => {\n                                          return (\n                                              <option key={index} value={data.category + '|' + data._id} >{data.category}</option>\n                                          );\n                                      })\n                                      :\n                                      <option disabled>{\"Category not available\"}</option>\n                                  }\n                              </select>\n                          </div>\n                          </div>\n                          <div className=\"col-lg-4 col-lg-offset-2 col-md-4 col-md-offset-2  col-sm-4 col-xs-6  inputFields\">\n                              <label>Select File <i className=\"redFont\">*</i></label>\n                              <div className=\"input-group\">\n                                  <span className=\"adminBlkUpldIcon input-group-addon\" id=\"basic-addon1\"><i className=\"fa fa-cloud-upload\" aria-hidden=\"true\"></i></span>\n                                  <input className=\"form-control adminBlkUploadBtn\" name=\"templatefile\" id=\"templatefile\"\n                                      ref={this.fileInput}\n                                      type=\"file\"\n                                      accept=\".xlsx, .xls\"\n                                      onChange={this.docBrowse.bind(this)}\n                                  />\n                              </div>\n                              <div id=\"templateError\"></div>\n                              <div className=\"upldProdFileHere\"> Upload Your Template File Here:</div>\n                          </div>\n                          <div className=\"col-lg-4 col-md-4 col-sm-12 col-xs-12 mt\">\n                              <button onClick={this.addTemplate.bind(this)} className=\"submitBtn btn btnSubmit col-lg-4 col-md-4 col-sm-3 col-xs-3 pull-left\">Save</button>\n                          </div>    \n                          <br/>\n                          </form>\n\n                          <IAssureTable \n                              tableHeading={this.state.tableHeading}\n                              twoLevelHeader={this.state.twoLevelHeader} \n                              dataCount={this.state.dataCount}\n                              tableData={this.state.tableData}\n                              getData={this.getData.bind(this)}\n                              tableObjects={this.state.tableObjects}\n                          /> \n                        </div>\n                    </div>\n                    \n                        \n                </div>\n            </div>\n        </section>\n      </div>\n        );\n    }\n}\nexport default withRouter(TemplateManagement);\n"]},"metadata":{},"sourceType":"module"}